# NatureTech Mobile Dashboard UI & Backend

Welcome to the **NatureTech Mobile Dashboard**, a comprehensive full-stack application designed for farm management, field data collection, and environmental monitoring. This system enables farmers and managers to track crop health, visualize yield data, and manage farm tasks efficiently.

---

## ğŸš€ Project Overview

The application is built to bridge the gap between field operations and digital management.
- **Frontend**: A mobile-first React application enabling users to log data, view map layers, and receive insights.
- **Backend**: A robust Node.js/Express server that processes data, runs a rules engine for alerts, and manages a PostgreSQL database.

### Key Features
*   **Real-time Dashboard**: Visualize Crop Yield, Farm Insights, and TNFD (Nature-related) compliance metrics.
*   **Field Data Collection**: Offline-capable forms for logging crop measurements (biomass, pests, soil health).
*   **Smart Alerts**: Automated detection of risks like Fire, Drought, and Pest Outbreaks based on environmental inputs.
*   **Task Management**: Role-based task assignment between Managers and Farmers.
*   **Mapping**: Interactive maps showing site boundaries, satellite layers, and plant fertility data.

---

## ğŸ›  Tech Stack

*   **Frontend**: React (Vite), TypeScript, Tailwind CSS, Radix UI, Recharts.
*   **Backend**: Node.js, Express.js.
*   **Database**: PostgreSQL (with PostGIS support recommended but not strictly required for basic features).
*   **Authentication**: Custom implementation using JWT/Sessions (via `bcrypt` for password hashing).
*   **AI Integration**: Google Gemini API for generating farm insights.

---

## âš™ï¸ Installation & Setup Guide

Follow these steps to get the application running on your local machine.

### 1. Prerequisites
*   **Node.js** (v18 or higher)
*   **PostgreSQL** (v14 or higher) installed and running.

### 2. Database Setup
1.  Create a new database in PostgreSQL (e.g., `naturetech_db`).
2.  Run the provided `build.sql` script to generate the schema.
    ```bash
    # Using command line
    psql -U postgres -d naturetech_db -f build.sql
    ```
    *Alternatively, copy the contents of `build.sql` and run it in a tool like pgAdmin or DBeaver.*

### 3. Backend Configuration
1.  Navigate to the server folder: `cd server`
2.  Install dependencies: `npm install`
3.  Configure Environment Variables:
    *   Copy `.env.example` to a new file named `.env`.
    *   Update `DATABASE_URL` with your credentials:
        ```
        DATABASE_URL=postgresql://<username>:<password>@localhost:5432/naturetech_db
        PORT=3000
        ```
4.  Start the server:
    ```bash
    npm run dev
    ```
    *Server should run on http://localhost:3000*

### 4. Frontend Configuration
1.  Navigate to the root folder: `cd ..`
2.  Install dependencies: `npm install`
3.  Configure Environment Variables:
    *   Create a `.env` file in the root directory.
    *   Add your Gemini API Key (Required for AI features):
        ```
        VITE_GEMINI_API_KEY=your_actual_api_key_here
        ```
4.  Start the application:
    ```bash
    npm run dev
    ```
    *App should run on http://localhost:5173*

---

## ğŸ“– Backend Documentation

### Database Structure
The `build.sql` script creates the following key tables:

*   **`organisations` & `profiles`**: User management and multi-tenancy support. Users belong to organisations.
*   **`sites` & `site_units`**: Geospatial data for farms (polygons, blocks).
*   **`observations`**: The core data table storing field submissions. It includes distinct columns for:
    *   **Bamboo Metrics**: `oldBambooNumberofculms`, `newBambooShoots`.
    *   **Tree/Fruit Metrics**: `fruitHeight`, `fruitDiameter`.
    *   **Soil Data**: `Soilmoisture`, `pHvalue`, `Electricalconductivity`.
*   **`alerts`**: generated by the Rules Engine when observations exceed safety thresholds.
*   **`recommendations`**: AI or rule-based suggestions linked to alerts.
*   **`tnfd_metrics`**: Stores validated environmental data for compliance reporting.

### Core Logic
*   **Biomass Calculation**: When data is submitted, the backend calculates `totalplantbiomass` using species-specific density and volume lookup tables.
*   **Rules Engine**: (`rulesEngine.js`) evaluated triggered alerts based on:
    *   **Fire Risk**: High Temp + Low Moisture.
    *   **Drought**: Low Soil Moisture + High Evapotranspiration.
    *   **Salinity**: Electrical Conductivity > 4.0 dS/m.

---

## ğŸ“± Frontend Guide

### Navigation Flow
1.  **Auth**: Login / Sign Up. (New users must join an Organisation).
2.  **Main Menu**: Central hub to access all modules.
3.  **Dashboard**: High-level metrics.
    *   *Yield Metrics*: Uses "Forward Fill" logic to smooth biomass trends over time.
    *   *Insights*: AI-generated summaries of farm health.
4.  **Capture Field Data**: The primary input form.
    *   Supports Barcode scanning (simulated input).
    *   Dynamic fields based on "Crop Type" (Bamboo vs Trees).
5.  **Records**: View historial logs, tasks, and alerts.

### ğŸ§ª How to Test (Demo Triggers)
You can trigger specific system behaviors by entering these values in the "Capture Field Data" form:

| Scenario | Input Values | Result |
| :--- | :--- | :--- |
| **Critical Fire Alert** ğŸš¨ | Temp: `38`, Moisture: `15` | Red Alert: "High Fire Risk" |
| **Flood Warning** âš ï¸ | Precipitation: `120` | Critical Alert: "Flood Risk" |
| **Salinity Trend** ğŸ“ˆ | EC: `3.8` | Warning: "Salinity approaching limit" |
| **Drought Risk** ğŸœï¸ | Soil Moisture: `< 10` | Critical Alert: "Severe Drought" |
| **Pest Outbreak** ğŸ› | Visible Pests: `Yes` | Critical Alert: "Active Pest Outbreak" |

---

## âš–ï¸ Attributions
*   **UI Components**: Built with [shadcn/ui](https://ui.shadcn.com/) (MIT License).
*   **Icons**: [Lucide React](https://lucide.dev/).
*   **Images**: Placeholder images via [Unsplash](https://unsplash.com).
